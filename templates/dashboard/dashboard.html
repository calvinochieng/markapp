{% extends "base.html" %}
{% block title %}Delivery Management Dashboard{% endblock title %}


  {% block custom_style %}
  <style>
    :root {
      --primary-color:rgb(0, 128, 255);
      --secondary-color: #3498db;
      --accent-color: #e74c3c;
    }

    body {
      font-family: 'Montserrat', sans-serif;
      {% comment %} background-color: #f8f9fa; {% endcomment %}
    }

    .custom-navbar {
      {% comment %} background-color: var(--primary-color); {% endcomment %}
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    .navbar-item, .navbar-link {
      {% comment %} color: #fff !important; {% endcomment %}
      transition: all 0.3s ease;
    }

    .navbar-item:hover, .navbar-link:hover {
      background-color: hsla(0, 0.00%, 100.00%, 0.10) !important;
    }

    .dashboard-card {
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      border-radius: 12px;
      overflow: hidden;
    }

    .dashboard-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0,0,0,0.1);
      border:1px #2a2a2e solid;
    }

    .stat-number {
      font-size: 2.5rem;
      font-weight: 700;
      color: var(--primary-color);
    }

    .recent-deliveries {
      max-height: 400px;
      overflow-y: auto;
      box-shadow: 0 0 0 rgba(0,0,0,0.1);
    }

    .section {
      padding: 3rem 1.5rem;
    }

    .footer {
      background-color: var(--primary-color);
      color: #fff;
      padding: 2rem 1.5rem;
    }

    @media screen and (max-width: 768px) {
      .hero {
        padding: 2rem 1rem;
      }
      
      .stat-number {
        font-size: 1.8rem;
      }
    }
    footer{display: none;}
  </style>
  {% endblock custom_style %}
  {% block content %}
    <section class="hero is-medium">
        <div class="hero-body">
            <h1 class="title is-1 has-text-centered mb-6">Delivery Management Dashboard</h1>
            
            <!-- Stats Overview -->
            <div class="columns is-multiline mb-6">
                <div class="column is-3">
                    <div class="dashboard-card box ">
                        <p class="has-text-grey">Total Deliveries</p>
                        <p class="stat-number" id="total-deliveries">
                        {{total_deliveries}}
                        </p>
                        <p class="has-text-success"><i class="fas fa-arrow-up"></i> 12% from last month</p>
                        <button class="button  mt-4 is-primary is-rounded has-text-weight-bold py-4" 
                                onclick="window.location.href='/admin/app/delivery/add/'">
                            <i class="fas fa-plus-circle mr-2"></i>New Delivery
                        </button>
                    </div>
                </div>
                <div class="column is-3">
                    <div class="dashboard-card box ">
                        <p class="has-text-grey">Active Staff</p>
                        <p class="stat-number" id="active-staff">
                        {{active_staff}}
                        </p>
                        <p class="has-text-info">{{loaders_available}} Loaders Available</p>
                        <button class="button  mt-4 is-info is-rounded has-text-weight-bold py-4"
                                onclick="window.location.href='/admin/app/staff/add/'">
                            <i class="fas fa-user-plus mr-2"></i> Add Loader
                        </button>
                    </div>
                </div>
                <div class="column is-3">
                    <div class="dashboard-card box ">
                        <p class="has-text-grey">Loading/ Turnboy Expenses</p>
                        <p class="stat-number">Ksh <span id="total-salary">{{total_deliveries_amount}}/=</span></p>
                        <p class="has-text-warning">
                            <span class="has-text-grey">Loading</span> : {{total_loading_amount}}/= 
                            <span class="has-text-grey">Turnboy:</span> {{total_turnboy_payments}}/= 
                        </p>
                        <button class="button is-success mt-4 is-rounded has-text-weight-bold py-4"
                                onclick="window.location.href='/admin/app/monthlypayment/'">
                            <i class="fas fa-file-invoice-dollar mr-2"></i>Generate Payroll
                        </button>
                    </div>
                </div>
                <div class="column is-3">
                    <div class="dashboard-card box ">
                        <p class="has-text-grey">Active Vehicles</p>
                        <p class="stat-number" id="active-vehicles">{{active_vehicles}}</p>
                        <p class="has-text-danger">0 Under Maintenance</p>
                        <button class="button is-success mt-4 is-rounded has-text-weight-bold py-4"
                                onclick="window.location.href='/admin/app/monthlypayment/'">
                            <i class="fas fa-truck mr-2"></i>Add Vehicle
                        </button>
                    </div>
                </div>
            </div>
            <!-- Recent Deliveries Section -->   
            <div class="mt-6">
                <h2 class="title is-4 mb-4">Recent Deliveries</h2>
                <div class="box recent-deliveries px-0">
                <table class="table is-fullwidth is-hoverable">
                    <thead>
                        <tr class="px-4">
                            <th>Date</th>
                            <th>Vehicle</th>
                            <th>Driver</th>
                            <th>Location</th>
                            <th>Items Carried</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                    <!-- Dynamic content would go here -->
                    {% for delivery in deliveries %}
                        <tr>
                            <td>{{delivery.date}}</td>
                            <td>{{delivery.vehicle}}</td>
                            <td>{{delivery.driver.name}}</td>
                            <td>{{delivery.destination}}</td>
                            <td>{{delivery.items_carried}}</td>
                            <td>
                                {% if delivery.status %}
                                <span class="tag is-success">
                                        Completed
                                    {% else %}
                                <span class="tag is-warning">
                                        Pending
                                    {% endif %}
                                </span>
                            </td>
                            <td>
                            <button class="button is-small is-info">View</button>
                            <button class="button is-small is-warning">Edit</button>
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>
        </div> 
    </section>

{% endblock content %}

